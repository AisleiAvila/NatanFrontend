<h2>Gestão de Clientes</h2>
<div class="client-list-container">
  <div
    class="actions-row"
    style="display: flex; justify-content: flex-end; margin-bottom: 16px"
  >
    <button mat-raised-button color="primary" (click)="novoCliente()">
      <mat-icon>person_add</mat-icon>
      Novo Cliente
    </button>
  </div>
  <div class="filters-row">
    <mat-form-field appearance="outline" class="filter-field">
      <mat-label>Nome</mat-label>
      <input
        matInput
        [(ngModel)]="filterNome"
        (ngModelChange)="applyFilters()"
        placeholder="Filtrar por nome"
      />
    </mat-form-field>
    <mat-form-field appearance="outline" class="filter-field">
      <mat-label>E-mail</mat-label>
      <input
        matInput
        [(ngModel)]="filterEmail"
        (ngModelChange)="applyFilters()"
        placeholder="Filtrar por e-mail"
      />
    </mat-form-field>
    <mat-form-field appearance="outline" class="filter-field">
      <mat-label>Região</mat-label>
      <mat-select [(ngModel)]="filterRegion" (selectionChange)="applyFilters()">
        <mat-option value="">Todas</mat-option>
        <mat-option *ngFor="let region of regions" [value]="region.id"
          >{{ region.name }}</mat-option
        >
      </mat-select>
    </mat-form-field>
    <mat-form-field appearance="outline" class="filter-field">
      <mat-label>Status</mat-label>
      <mat-select [(ngModel)]="filterStatus" (selectionChange)="applyFilters()">
        <mat-option value="">Todos</mat-option>
        <mat-option *ngFor="let status of statusOptions" [value]="status.value"
          >{{ status.label }}</mat-option
        >
      </mat-select>
    </mat-form-field>
    <button
      mat-stroked-button
      color="primary"
      class="filter-field"
      style="align-self: end; min-width: 120px"
      (click)="limparFiltros()"
    >
      <mat-icon>clear</mat-icon>
      Limpar Filtros
    </button>
  </div>

  <table mat-table [dataSource]="dataSource" class="mat-elevation-z8">
    <ng-container matColumnDef="name">
      <th mat-header-cell *matHeaderCellDef>Nome</th>
      <td mat-cell *matCellDef="let client">{{ client.name }}</td>
    </ng-container>
    <ng-container matColumnDef="email">
      <th mat-header-cell *matHeaderCellDef>Email</th>
      <td mat-cell *matCellDef="let client">{{ client.email }}</td>
    </ng-container>
    <ng-container matColumnDef="telefone">
      <th mat-header-cell *matHeaderCellDef>Telefone</th>
      <td mat-cell *matCellDef="let client">{{ client.telefone }}</td>
    </ng-container>
    <ng-container matColumnDef="region">
      <th mat-header-cell *matHeaderCellDef>Região</th>
      <td mat-cell *matCellDef="let client">{{ client.region?.name }}</td>
    </ng-container>
    <ng-container matColumnDef="totalProjetos">
      <th mat-header-cell *matHeaderCellDef>Total de Projetos</th>
      <td mat-cell *matCellDef="let client">{{ client.totalProjetos }}</td>
    </ng-container>
    <ng-container matColumnDef="status">
      <th mat-header-cell *matHeaderCellDef>Status</th>
      <td mat-cell *matCellDef="let client">
        <span
          [ngClass]="{'ativo': client.status === 'ativo', 'inativo': client.status === 'inativo'}"
        >
          {{ client.status | titlecase }}
        </span>
      </td>
    </ng-container>
    <ng-container matColumnDef="actions">
      <th mat-header-cell *matHeaderCellDef>Ações</th>
      <td mat-cell *matCellDef="let client">
        <button mat-icon-button color="primary" (click)="editarCliente(client)">
          <mat-icon>edit</mat-icon>
        </button>
        <button mat-icon-button color="warn" (click)="excluirCliente(client)">
          <mat-icon>delete</mat-icon>
        </button>
      </td>
    </ng-container>
    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
  </table>
  <mat-paginator
    [pageSizeOptions]="[5, 10, 20]"
    showFirstLastButtons
  ></mat-paginator>
</div>
